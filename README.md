# EddiiBackend

<a alt="Nx logo" href="https://nx.dev" target="_blank" rel="noreferrer"><img src="https://raw.githubusercontent.com/nrwl/nx/master/images/nx-logo.png" width="45"></a>

✨ **This workspace has been generated by [Nx, a Smart, fast and extensible build system.](https://nx.dev)** ✨

## Understand this workspace

Run `nx graph` to see a diagram of the dependencies of the projects.

## Remote caching

Run `npx nx connect-to-nx-cloud` to enable [remote caching](https://nx.app) and make CI faster.

## Further help

Visit the [Nx Documentation](https://nx.dev) to learn more.

## Stack Build

1. Create Google Firebase Project under eddii@eddiihealth.com

    1. Enable Google Analytics for this project
    1. Add Firebase to your Apple app (add correct bundle ID)
    1. Download plist, copy and name it correctly in eddii-mobile-app repo `eddii-mobile-app/ios/Firebase/GoogleService-Info-${bundleID}.plist`
    1. Go to Project Settings -> Cloud Messaging -> Enable Cloud Messaging API (Legacy) -> Copy Server key (for SNS step below).

1. Create SNS Platform Application

    1. [SNS](https://us-east-1.console.aws.amazon.com/sns/v3/home?region=us-east-1#/mobile/create-app) -> Push notification platform === "FCM", enter Server key from above.
    1. Enable Delivery status logging -> Create new service role
    1. Copy ARN and add to CDK stack config.

1. Export AWS credentials to terminal

1. Bootstrap - `cdk bootstrap aws://$ACCOUNT_ID/$REGION`

1. Deploy - `cdk deploy $STACK`

1. Update Dexcom Secret.
   [Secrets Manager](https://us-east-1.console.aws.amazon.com/secretsmanager/landing?region=us-east-1) -> Find Dexcom Secret -> Update it to one from Dexcom

1. Copy all variables into the right `.env` file in eddii-mobile-app repo.

## Healtie

Update the schema
`rover graph introspect https://staging-api.gethealthie.com/graphql --output schema/healthie.graphql`
